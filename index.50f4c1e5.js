function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},u={},s={},n=t.parcelRequire94c2;null==n&&((n=function(e){if(e in u)return u[e].exports;if(e in s){var t=s[e];delete s[e];var n={id:e,exports:{}};return u[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){s[e]=t},t.parcelRequire94c2=n),n.register;var a=n("jMsY1"),r=n("kcAQ0");function o(e){let t=Array.from(document.querySelectorAll(".test-card"));t.sort((t,u)=>{let s,n;switch(e){case"time":return s=new Date(t.getAttribute("data-created-at")).getTime(),(n=new Date(u.getAttribute("data-created-at")).getTime())-s;case"name":return s=t.querySelector("h2").textContent.toLowerCase(),n=u.querySelector("h2").textContent.toLowerCase(),s.localeCompare(n);case"questions":return s=parseInt(t.querySelector(".test-info").textContent.split(" ")[0]),(n=parseInt(u.querySelector(".test-info").textContent.split(" ")[0]))-s;case"completions":return s=parseInt(t.querySelector(".test-info").textContent.split(" ")[4]),(n=parseInt(u.querySelector(".test-info").textContent.split(" ")[4]))-s;default:return 0}});let u=document.querySelector(".test-list");u.innerHTML="",t.forEach(e=>u.appendChild(e))}var i=n("nuyhG"),l=n("5a6Bh");const c=async t=>{try{let{data:u,error:s}=await (0,i.supabase).from("test_attempts").select("id").eq("test_id",t);if(s)throw s;let n=u.map(e=>e.id);n.length>0&&(await (0,i.supabase).from("question_answers").delete().in("attempt_id",n),await (0,i.supabase).from("test_attempts").delete().eq("test_id",t));let{data:a,error:r}=await (0,i.supabase).from("questions").select("id").eq("test_id",t);if(r)throw r;let o=a.map(e=>e.id);o.length>0&&(await (0,i.supabase).from("answers").delete().in("question_id",o),await (0,i.supabase).from("questions").delete().eq("test_id",t)),await (0,i.supabase).from("tests").delete().eq("id",t),e(l).Notify.success("Тест был успешно удалён")}catch(t){e(l).Notify.failure(`\u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430} \u{43F}\u{440}\u{438} \u{443}\u{434}\u{430}\u{43B}\u{435}\u{43D}\u{438}\u{438} \u{442}\u{435}\u{441}\u{442}\u{430}: ${t.message}`)}},d={testList:document.querySelector(".test-list"),target:document.querySelector(".js-guard")};let f=1,p=!0,m=new IntersectionObserver(h,{root:document.querySelector("#scrollArea"),rootMargin:"200px",threshold:1});async function h(e){for(let t of e)if(t.isIntersecting&&p)try{let e=await (0,a.loadTests)(f,9);if(e.length<9){d.testList.insertAdjacentHTML("beforeend",g(e)),o(w.value),p=!1,b(),m.unobserve(d.target);return}d.testList.insertAdjacentHTML("beforeend",g(e)),f++,b(),o(w.value)}catch(e){console.error("Помилка завантаження тестів:",e)}}function v(e){e.stopPropagation(),document.querySelectorAll(".menu-container").forEach(e=>{e.classList.remove("active")}),e.target.parentElement.classList.toggle("active")}function b(){document.querySelectorAll(".menu-button").forEach(e=>{e.addEventListener("click",v)})}function g(e){return o(w.value),e.map(({id:e,title:t,description:u,count_questions:s,completed:n,created_at:a})=>` <li class="test-card" data-created-at="${a}">
            <div class="card-content-wrapper">
            <div class="test-header">
                <h2 class = "test-title">${t||`\u{422}\u{435}\u{441}\u{442} #${e}`}</h2>
                <div class="menu-container">
                    <button class="menu-button">\u{22EE}</button>
                    <div class="dropdown-menu">
                        <button class="edit"><a class = "start-link" href="/questionary-builder.html">\u{420}\u{435}\u{434}\u{430}\u{433}\u{443}\u{432}\u{430}\u{442}\u{438}</a></button>
                        <button class="delete"onClick="deleteTest(${e})">\u{412}\u{438}\u{434}\u{430}\u{43B}\u{438}\u{442}\u{438}</button>
                        <button class="continue"><a class = "start-link" href="/walkthrough.html?test_id=${e}">\u{41F}\u{440}\u{43E}\u{434}\u{43E}\u{432}\u{436}\u{438}\u{442}\u{438}</a></button>
                    </div>
                </div>
            </div>
            <p class = "test-description">${u}</p>
            <p class="test-info">${s} \u{43F}\u{438}\u{442}\u{430}\u{43D}\u{44C} \u{2022} \u{41F}\u{440}\u{43E}\u{439}\u{434}\u{435}\u{43D}\u{43E} ${n} \u{440}\u{430}\u{437}\u{456}\u{432}</p>
            <p>${(0,r.timeSince)(a)}</p>
            </div>
            <div class="test-actions">
                <a class="start" href="/walkthrough.html?test_id=${e}">\u{417}\u{430}\u{43F}\u{443}\u{441}\u{442}\u{438}\u{442}\u{438}</a>
            </div>
        </li>`).join("")}document.addEventListener("click",function(e){e.target.closest(".menu-container")||document.querySelectorAll(".menu-container").forEach(e=>{e.classList.remove("active")})}),document.addEventListener("DOMContentLoaded",async function(){let e=await (0,a.loadTests)(f,9);d.testList.insertAdjacentHTML("beforeend",g(e)),m.observe(d.target),b(),f++});const w=document.getElementById("sort-type");w.addEventListener("change",e=>{o(e.target.value),o()}),window.deleteTest=c;
//# sourceMappingURL=index.50f4c1e5.js.map
