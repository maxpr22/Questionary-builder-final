import"./edit.446baefd.js";import"./edit.df487508.js";import"./Questionary-builder-final.2a43680d.js";function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},u={},s={},a=t.parcelRequired7c6;null==a&&((a=function(e){if(e in u)return u[e].exports;if(e in s){var t=s[e];delete s[e];var a={id:e,exports:{}};return u[e]=a,t.call(a.exports,a,a.exports),a.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){s[e]=t},t.parcelRequired7c6=a),a.register;var n=a("jMsY1"),r=a("kcAQ0");function o(e){let t=Array.from(document.querySelectorAll(".test-card"));t.sort((t,u)=>{let s,a;switch(e){case"time":return s=new Date(t.getAttribute("data-created-at")).getTime(),(a=new Date(u.getAttribute("data-created-at")).getTime())-s;case"name":return s=t.querySelector("h2").textContent.toLowerCase(),a=u.querySelector("h2").textContent.toLowerCase(),s.localeCompare(a);case"questions":return s=parseInt(t.querySelector(".test-info").textContent.split(" ")[0]),(a=parseInt(u.querySelector(".test-info").textContent.split(" ")[0]))-s;case"completions":return s=parseInt(t.querySelector(".test-info").textContent.split(" ")[4]),(a=parseInt(u.querySelector(".test-info").textContent.split(" ")[4]))-s;default:return 0}});let u=document.querySelector(".test-list");u.innerHTML="",t.forEach(e=>u.appendChild(e))}var i=a("nuyhG"),l=a("5a6Bh");let c=async t=>{try{let{data:u,error:s}=await (0,i.supabase).from("test_attempts").select("id").eq("test_id",t);if(s)throw s;let a=u.map(e=>e.id);a.length>0&&(await (0,i.supabase).from("question_answers").delete().in("attempt_id",a),await (0,i.supabase).from("test_attempts").delete().eq("test_id",t));let{data:n,error:r}=await (0,i.supabase).from("questions").select("id").eq("test_id",t);if(r)throw r;let o=n.map(e=>e.id);o.length>0&&(await (0,i.supabase).from("answers").delete().in("question_id",o),await (0,i.supabase).from("questions").delete().eq("test_id",t)),await (0,i.supabase).from("tests").delete().eq("id",t),e(l).Notify.success("Тест был успешно удалён"),window.location.reload()}catch(t){e(l).Notify.failure(`\u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430} \u{43F}\u{440}\u{438} \u{443}\u{434}\u{430}\u{43B}\u{435}\u{43D}\u{438}\u{438} \u{442}\u{435}\u{441}\u{442}\u{430}: ${t.message}`)}},d={testList:document.querySelector(".test-list"),target:document.querySelector(".js-guard")},f=1,p=!0,m=new IntersectionObserver(h,{root:document.querySelector("#scrollArea"),rootMargin:"200px",threshold:1});async function h(e){for(let t of e)if(t.isIntersecting&&p)try{let e=await (0,n.loadTests)(f,9);if(e.length<9){d.testList.insertAdjacentHTML("beforeend",w(e)),o(g.value),p=!1,v(),m.unobserve(d.target);return}d.testList.insertAdjacentHTML("beforeend",w(e)),f++,v(),o(g.value)}catch(e){console.error("Помилка завантаження тестів:",e)}}function b(e){e.stopPropagation(),document.querySelectorAll(".menu-container").forEach(e=>{e.classList.remove("active")}),e.target.parentElement.classList.toggle("active")}function v(){document.querySelectorAll(".menu-button").forEach(e=>{e.addEventListener("click",b)})}function w(e){return o(g.value),e.map(({id:e,title:t,description:u,count_questions:s,completed:a,created_at:n})=>` <li class="test-card" data-created-at="${n}">
            <div class="card-content-wrapper">
            <div class="test-header">
                <h2 class = "test-title">${t||`\u{422}\u{435}\u{441}\u{442} #${e}`}</h2>
                <div class="menu-container">
                    <button class="menu-button">\u{22EE}</button>
                    <div class="dropdown-menu">
                        <button class="edit"><a class = "start-link" href="/edit.html?test_id=${e}">\u{420}\u{435}\u{434}\u{430}\u{433}\u{443}\u{432}\u{430}\u{442}\u{438}</a></button>
                        <button class="delete"onClick="deleteTest(${e})">\u{412}\u{438}\u{434}\u{430}\u{43B}\u{438}\u{442}\u{438}</button>
                        <button class="continue"><a class = "start-link" href="/walkthrough.html?test_id=${e}">\u{41F}\u{440}\u{43E}\u{434}\u{43E}\u{432}\u{436}\u{438}\u{442}\u{438}</a></button>
                    </div>
                </div>
            </div>
            <p class = "test-description">${u}</p>
            <p class="test-info">${s} \u{43F}\u{438}\u{442}\u{430}\u{43D}\u{44C} \u{2022} \u{41F}\u{440}\u{43E}\u{439}\u{434}\u{435}\u{43D}\u{43E} ${a} \u{440}\u{430}\u{437}\u{456}\u{432}</p>
            <p>${(0,r.timeSince)(n)}</p>
            </div>
            <div class="test-actions">
                <a class="start" href="/walkthrough.html?test_id=${e}">\u{417}\u{430}\u{43F}\u{443}\u{441}\u{442}\u{438}\u{442}\u{438}</a>
            </div>
        </li>`).join("")}document.addEventListener("click",function(e){e.target.closest(".menu-container")||document.querySelectorAll(".menu-container").forEach(e=>{e.classList.remove("active")})}),document.addEventListener("DOMContentLoaded",async function(){let e=await (0,n.loadTests)(f,9);d.testList.insertAdjacentHTML("beforeend",w(e)),m.observe(d.target),v(),f++});let g=document.getElementById("sort-type");g.addEventListener("change",e=>{o(e.target.value),o()}),window.deleteTest=c;
//# sourceMappingURL=Questionary-builder-final.c757f459.js.map
